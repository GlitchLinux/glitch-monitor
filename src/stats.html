<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gLiTcH-SERVER Extended Statistics</title>
    <link rel="icon" href="https://glitchserver.com/glitch.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <style>
        .section-title {
            color: #32cd32;
            font-size: 1.2em;
            margin: 25px 0 15px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid #404040;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .alert-box {
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-weight: 500;
        }
        .alert-box.warning {
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid #ffa500;
            color: #ffa500;
        }
        .alert-box.danger {
            background: rgba(255, 69, 0, 0.2);
            border: 1px solid #ff4500;
            color: #ff4500;
        }
        .alert-box.ok {
            background: rgba(50, 205, 50, 0.2);
            border: 1px solid #32cd32;
            color: #32cd32;
        }
        .service-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #3a3a3a;
        }
        .service-name {
            font-family: 'Courier New', monospace;
            color: #d5d5d5;
        }
        .service-status {
            padding: 2px 10px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: bold;
        }
        .service-status.active {
            background: rgba(50, 205, 50, 0.2);
            color: #32cd32;
        }
        .service-status.inactive {
            background: rgba(255, 69, 0, 0.2);
            color: #ff4500;
        }
        .ssl-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #3a3a3a;
        }
        .ssl-domain {
            font-family: 'Courier New', monospace;
            color: #d5d5d5;
        }
        .ssl-days {
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
        }
        .ssl-days.ok { background: rgba(50, 205, 50, 0.2); color: #32cd32; }
        .ssl-days.warning { background: rgba(255, 165, 0, 0.2); color: #ffa500; }
        .ssl-days.danger { background: rgba(255, 69, 0, 0.2); color: #ff4500; }
        .pre-block {
            background: #2a2a2a;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            color: #aaa;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }
        .response-time {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #3a3a3a;
        }
        .response-time .domain { color: #d5d5d5; }
        .response-time .time { color: #32cd32; font-family: monospace; }
        .mini-stat {
            display: inline-block;
            background: #3a3a3a;
            padding: 4px 10px;
            border-radius: 4px;
            margin: 2px;
            font-size: 0.9em;
        }
        .mini-stat .label { color: #888; }
        .mini-stat .value { color: #32cd32; font-weight: bold; }
        .top-list {
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            color: #aaa;
        }
        .top-list-item {
            padding: 4px 0;
            border-bottom: 1px solid #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="compact-header">
            <div class="header-content">
                <div class="header-main">
                    <div class="server-title">
                        <h1>üìä EXTENDED STATISTICS</h1>
                        <div class="status-indicator">
                            <span class="status-dot"></span>
                            <span class="status-text">Live Data</span>
                        </div>
                    </div>
                    <div class="header-buttons">
                        <a href="/dashboard.html" class="glow-btn"><span class="btn-icon">üè†</span> DASHBOARD</a>
                        <a href="/fail2ban.html" target="_blank" class="glow-btn"><span class="btn-icon">üõ°Ô∏è</span> FAIL2BAN</a>
                        <a href="/status-download.php" class="glow-btn"><span class="btn-icon">üì•</span> STATUS</a>
                        <a href="/clogger-live.html" target="_blank" class="glow-btn"><span class="btn-icon">>_</span> CLOGGER</a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Alerts Section -->
        <div id="alerts-section">
            <div class="section-title">‚ö†Ô∏è System Alerts</div>
            <div id="alerts-container">
                <div class="alert-box ok">‚úì All systems operational</div>
            </div>
        </div>

        <!-- Security Section -->
        <div class="section-title">üîí Security</div>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üö´</span>
                    <h3>Failed SSH (24h)</h3>
                </div>
                <div class="stat-value" id="ssh-failed-total">0</div>
                <div class="stat-details">Last 24 hours</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üìÖ</span>
                    <h3>Failed SSH (Today)</h3>
                </div>
                <div class="stat-value" id="ssh-failed-today">0</div>
                <div class="stat-details">Since midnight</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üë•</span>
                    <h3>Active Sessions</h3>
                </div>
                <div class="stat-value" id="active-sessions">0</div>
                <div class="stat-details">Logged in users</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üè¥‚Äç‚ò†Ô∏è</span>
                    <h3>Top Attackers</h3>
                </div>
                <div class="pre-block" id="top-attackers">Loading...</div>
            </div>
        </div>

        
        <!-- Apache Section -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üîå</span>
                    <h3>HTTPS Connections</h3>
                </div>
                <div class="stat-value" id="apache-https">0</div>
                <div class="stat-details">Port 443</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üìä</span>
                    <h3>Requests Today</h3>
                </div>
                <div class="stat-value" id="apache-requests">0</div>
                <div class="stat-details">Total HTTP requests</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">‚ö†Ô∏è</span>
                    <h3>HTTP Errors Today</h3>
                </div>
                <div class="stat-value small-text">
                    <span class="mini-stat"><span class="label">4xx:</span> <span class="value" id="errors-4xx">0</span></span>
                    <span class="mini-stat"><span class="label">5xx:</span> <span class="value" id="errors-5xx">0</span></span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üîù</span>
                    <h3>Top IPs Today</h3>
                </div>
                <div class="pre-block" id="top-ips">Loading...</div>
            </div>
        </div>

        <!-- Network Section -->
        <div class="section-title">üì° Network</div>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">‚¨áÔ∏è</span>
                    <h3>Data Received</h3>
                </div>
                <div class="stat-value" id="network-rx">0 GB</div>
                <div class="stat-details">Since boot</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">‚¨ÜÔ∏è</span>
                    <h3>Data Served</h3>
                </div>
                <div class="stat-value" id="network-tx">0 GB</div>
                <div class="stat-details">Since boot</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üîó</span>
                    <h3>Connections</h3>
                </div>
                <div class="stat-value small-text">
                    <span class="mini-stat"><span class="label">ESTABLISHED:</span> <span class="value" id="conn-established">0</span></span>
                    <span class="mini-stat"><span class="label">TIME_WAIT:</span> <span class="value" id="conn-timewait">0</span></span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üö™</span>
                    <h3>Open Ports</h3>
                </div>
                <div class="pre-block" id="open-ports">Loading...</div>
            </div>
        </div>

        <!-- Storage Section -->
        <div class="section-title">üíæ Storage</div>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üåê</span>
                    <h3>/var/www</h3>
                </div>
                <div class="stat-value" id="www-size">-</div>
                <div class="stat-details">Web content</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üìù</span>
                    <h3>/var/log</h3>
                </div>
                <div class="stat-value" id="log-size">-</div>
                <div class="stat-details">System logs</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">ü§ñ</span>
                    <h3>/CLAUDE-LOG</h3>
                </div>
                <div class="stat-value" id="claude-log-size">-</div>
                <div class="stat-details">Clogger data</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üìä</span>
                    <h3>Inode Usage</h3>
                </div>
                <div class="stat-value" id="inode-usage">-</div>
                <div class="stat-details">File count capacity</div>
            </div>
        </div>

        <!-- Services Section -->
        <div class="section-title">‚öôÔ∏è Services</div>
        <div class="stats-grid">
            <div class="stat-card" style="grid-column: span 2;">
                <div class="stat-header">
                    <span class="stat-icon">üîß</span>
                    <h3>Service Status</h3>
                </div>
                <div id="services-list">Loading...</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">‚ùå</span>
                    <h3>Failed Services</h3>
                </div>
                <div class="pre-block" id="failed-services">Loading...</div>
            </div>
        </div>

        <!-- SSL Certificates Section -->
        <div class="section-title">üîê SSL Certificates</div>
        <div class="stats-grid">
            <div class="stat-card" style="grid-column: span 2;">
                <div class="stat-header">
                    <span class="stat-icon">üìú</span>
                    <h3>Certificate Expiry</h3>
                </div>
                <div id="ssl-list">Loading...</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">‚è±Ô∏è</span>
                    <h3>Response Times</h3>
                </div>
                <div id="response-times">Loading...</div>
            </div>
        </div>

        <!-- Clogger Section -->
        <div class="section-title">üìã Clogger Audit Log</div>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üìä</span>
                    <h3>Total Entries</h3>
                </div>
                <div class="stat-value" id="clogger-total">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-icon">üìÖ</span>
                    <h3>Today's Entries</h3>
                </div>
                <div class="stat-value" id="clogger-today">0</div>
            </div>
            <div class="stat-card" style="grid-column: span 2;">
                <div class="stat-header">
                    <span class="stat-icon">üïê</span>
                    <h3>Last Entry</h3>
                </div>
                <div class="pre-block" id="clogger-last">Loading...</div>
            </div>
        </div>

        <footer>
            <div class="tech-stack">
                <span class="tech-badge">üîÑ Auto-refresh: 10s</span>
                <span class="tech-badge" id="last-update-badge">Updated: --</span>
            </div>
            <p class="footer-text">‚ú® gLiTcH-SERVER Extended Monitoring</p>
        </footer>
    </div>

    <script>
        const REFRESH_INTERVAL = 10000;

        async function fetchStats() {
            try {
                const response = await fetch('stats-extended.php');
                const data = await response.json();
                updateDashboard(data);
            } catch (error) {
                console.error('Error fetching stats:', error);
            }
        }

        function updateDashboard(data) {
            // Alerts
            const alertsContainer = document.getElementById('alerts-container');
            if (data.alerts && data.alerts.length > 0) {
                alertsContainer.innerHTML = data.alerts.map(a => 
                    `<div class="alert-box ${a.type}">${a.message}</div>`
                ).join('');
            } else {
                alertsContainer.innerHTML = '<div class="alert-box ok">‚úì All systems operational</div>';
            }

            // Security
            document.getElementById('ssh-failed-total').textContent = data.security.failed_total;
            document.getElementById('ssh-failed-today').textContent = data.security.failed_today;
            document.getElementById('active-sessions').textContent = data.security.active_sessions;
            document.getElementById('top-attackers').textContent = data.security.top_attackers || 'None detected';

            // Apache
            document.getElementById('apache-https').textContent = data.apache.connections_https;
            document.getElementById('apache-requests').textContent = data.apache.requests_today.toLocaleString();
            document.getElementById('errors-4xx').textContent = data.apache.errors_4xx;
            document.getElementById('errors-5xx').textContent = data.apache.errors_5xx;
            document.getElementById('top-ips').textContent = data.apache.top_ips || 'No data';

            // Network
            document.getElementById('network-rx').textContent = data.network.rx_gb + ' GB';
            document.getElementById('network-tx').textContent = data.network.tx_gb + ' GB';
            document.getElementById('conn-established').textContent = data.network.established;
            document.getElementById('conn-timewait').textContent = data.network.time_wait;
            document.getElementById('open-ports').textContent = data.network.open_ports || 'None';

            // Storage
            document.getElementById('www-size').textContent = data.storage.www_size;
            document.getElementById('log-size').textContent = data.storage.log_size;
            document.getElementById('claude-log-size').textContent = data.storage.claude_log_size;
            document.getElementById('inode-usage').textContent = data.storage.inode_usage;

            // Services
            const servicesHtml = Object.entries(data.services.services).map(([name, info]) => `
                <div class="service-row">
                    <span class="service-name">${name}</span>
                    <span class="service-status ${info.active ? 'active' : 'inactive'}">${info.status}</span>
                </div>
            `).join('');
            document.getElementById('services-list').innerHTML = servicesHtml;
            document.getElementById('failed-services').textContent = data.services.failed;

            // SSL
            const sslHtml = Object.entries(data.ssl).map(([domain, info]) => `
                <div class="ssl-row">
                    <span class="ssl-domain">${domain}</span>
                    <span class="ssl-days ${info.status}">${info.days_left !== null ? info.days_left + ' days' : 'Unknown'}</span>
                </div>
            `).join('');
            document.getElementById('ssl-list').innerHTML = sslHtml;

            // Response times
            const rtHtml = Object.entries(data.response_times).map(([domain, time]) => `
                <div class="response-time">
                    <span class="domain">${domain}</span>
                    <span class="time">${time}</span>
                </div>
            `).join('');
            document.getElementById('response-times').innerHTML = rtHtml;

            // Clogger
            document.getElementById('clogger-total').textContent = data.clogger.total;
            document.getElementById('clogger-today').textContent = data.clogger.today;
            document.getElementById('clogger-last').textContent = data.clogger.last_entry || 'No entries';

            // Update timestamp
            document.getElementById('last-update-badge').textContent = 'Updated: ' + new Date().toLocaleTimeString();
        }

        // Initialize
        fetchStats();
        setInterval(fetchStats, REFRESH_INTERVAL);
    </script>
</body>
</html>
